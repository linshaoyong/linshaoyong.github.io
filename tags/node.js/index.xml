<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>node.js on 记事本</title>
    <link>https://linshaoyong.github.io/tags/node.js/</link>
    <description>Recent content in node.js on 记事本</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Wed, 10 Mar 2021 22:12:50 +0000</lastBuildDate><atom:link href="https://linshaoyong.github.io/tags/node.js/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Event loop 介绍（二）</title>
      <link>https://linshaoyong.github.io/event-loop-02/</link>
      <pubDate>Wed, 10 Mar 2021 22:12:50 +0000</pubDate>
      
      <guid>https://linshaoyong.github.io/event-loop-02/</guid>
      <description>event loop通常联合Reactor设计模式一起使用。在Node.js中每个异步IO操作都对应一个handler（也叫回调函数/callback）。当IO操作触发事件，相应的回调函数进入执行队列，event loop从队列中取出callback执行。event loop是单线程的，所以callback要尽量轻量。
Node.js Node.js进程启动后，先初始化event loop，再执行JavaScript文件，之后通过event loop循环执行异步操作的callbacks。在Node.js里，event loop分为多个阶段（phase），如下图所示
每个phase都有一个队列，存放该phase需要执行的callbacks。每个phase的说明可以参考Node.js官方文档，解释得比较详细了。
libuv libuv is a multi-platform support library with a focus on asynchronous I/O. It was primarily developed for use by Node.js, but it’s also used by Luvit, Julia, pyuv, and others.
实际上，Node.js的event loop依赖libuv实现，可以通过libuv了解更底层的实现。
event loop可以说是libuv的核心部分，在libuv也可以看到跟Node.js一样的phase
从libuv的代码，可以看到event loop的执行流程。
int uv_run(uv_loop_t* loop, uv_run_mode mode) { int timeout; int r; int ran_pending; r = uv__loop_alive(loop); if (!r) uv__update_time(loop); while (r != 0 &amp;amp;&amp;amp; loop-&amp;gt;stop_flag == 0) { uv__update_time(loop); uv__run_timers(loop); ran_pending = uv__run_pending(loop); uv__run_idle(loop); uv__run_prepare(loop); timeout = 0; if ((mode == UV_RUN_ONCE &amp;amp;&amp;amp; !</description>
    </item>
    
    <item>
      <title>Event loop 介绍（一）</title>
      <link>https://linshaoyong.github.io/event-loop-01/</link>
      <pubDate>Tue, 09 Mar 2021 21:15:56 +0000</pubDate>
      
      <guid>https://linshaoyong.github.io/event-loop-01/</guid>
      <description>Event loop Event loop是异步编程的基础，Node.js通过Event loop实现了高性能非阻塞IO操作。了解Event loop，有助于了解程序背后的运行机制。本系列文章是我的学习总结，期间参考了一些很棒的资料，强烈推荐阅读。
参考资料  What the heck is the event loop anyway? Event Loop and the Big Picture — NodeJS Event Loop Node.js Design Patterns event-loop-timers-and-nexttick  准备工具 Node.js Node.js® is a JavaScript runtime built on Chrome&amp;rsquo;s V8 JavaScript engine.
为了方便使用多版本Node.js，可以用 nvm安装node。
$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.37.2/install.sh | bash $ nvm install node V8 V8 is Google’s open source high-performance JavaScript and WebAssembly engine, written in C++. It is used in Chrome and in Node.</description>
    </item>
    
  </channel>
</rss>
